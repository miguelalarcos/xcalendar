<template name="home">
    <div align="center">
        <h1>Demo of xCalendar</h1>
        <h3>You have to select a patient and a calendar</h3>
        Click on a patient id:
        {{#each patients}}
            <div>
                <a class="patient" href="" _id="{{this._id}}">{{this._id}}</a> {{this.name}} {{this.surname}}
            </div>
        {{/each}}
        Click on a calendar id:
        {{#each calendars}}
            <div>
                <a class="calendar" href="" _id="{{this._id}}">{{this._id}}</a> {{this.name}}
            </div>
        {{/each}}
        {{> xcalendar}}
        {{> dateAskModal }}
        {{> dateUpdateAskModal}}
        {{> dateRemoveAskModal}}
        <button class="ui button show-modal">show modal</button>
        {{> modal}}
    </div>
</template>

<template name="modal">
    <div id="modalId" class="xmodal {{modalShow}}">
        <div class="center">
            {{> UI.dynamic template=template}}
        </div>
    </div>
</template>

<template name="modal1">
    <div>
        <div class="ui input">
            <input type="text">
            <button class="ui button close">close</button>
        </div>
    </div>
</template>

<template name="xCalendarDayHead">
    <th></th><th>NHC</th><th>name</th><th>text</th>
</template>

<template name="xCalendarDayEmptyRow">
    <tr class="empty-day-row"><td>{{this}}</td></tr>
</template>

<template name="xCalendarDayRow">
   <tr _id="{{this.doc._id}}" class="event-day-row {{this.doc.status}}">
       <td>{{this.slot}}</td>
       <td>{{this.doc.patient.nhc}}</td>
       <td>{{this.doc.patient.fullName}}</td>
       <td class="patient-text">
           {{sub this.doc.text 25}}
           <div class="xpopup">
               <b>{{this.doc.patient.nhc}}</b>, {{this.doc.patient.fullName}}
               <p>{{this.doc.text}}</p>
           </div>
       </td>
   </tr>
</template>

<template name="xCalendarDayTop">
    {{>xCalendarButtonMinusDay}}
    {{>xCalendarButtonPlusDay}}
    {{>xCalendarButtonToday}}
    <b>{{formatDate this.date}}</b>
    {{>xCalendarButtonChangeView}}
</template>

<template name="xDayCalendarRow">
    {{this}}
</template>

<template name="xCalendarWeekLeft">
    {{#if display this}}
        <div class="cursive">{{this}}</div>
    {{/if}}
</template>

<template name="xCalendarWeekTop">
    {{>xCalendarButtonMinus}}
    {{>xCalendarButtonPlus}}
    {{>xCalendarButtonToday}}
    {{#if displayCancelReprogramming}}
        <a href="" id="cancelReprogramming">Cancel reprogramming</a>
    {{/if}}
    <span>
        <span class="title">{{this.calendar}}</span>
        <span><b>&nbsp;&nbsp;&nbsp;&nbsp;{{formatDateMonthYear this.date}}</b></span>
    </span>
    {{>xCalendarButtonChangeView}}
</template>

<template name="xCalendarWeekHead">
    {{formatDateDay this}}
</template>

<template name="xCalendarEvent">
    <div class="patient-event {{this.status}}">
        <b><a href="" class="delete-event" style="float: right">x</a></b>
        <span style="float: right">&nbsp;&nbsp;</span>
        <b><a href="" class="reprogramming-event" style="float: right">R</a></b>
        <div class="content-patient-event"><div><b>{{this.patient.nhc}}</b></div>{{this.patient.name}} {{this.patient.surname}}, {{sub this.text 25}}</div>
        <div class="xpopup">
            <b>{{this.patient.nhc}}</b>, {{this.patient.name}}, {{formatDateTime this.date}}
            <p>{{this.text}}</p>
        </div>
    </div>
    <!--<div class="ui popup">
        <div class="header">{{this.patient.nhc}}, {{this.patient.name}}, {{formatDateTime this.date}}</div>
        <div class="content-popup">{{this.text}}</div>
    </div>-->
</template>

<template name="xCalendarSlot">
    <div class="empty-slot">click for appointment</div>
</template>

<template name="dateAskModal">
    {{#with patient}}
    <div id='dateAskModal' class="ui modal">
        <div class="header">
            Alert!
        </div>
        <div class="content">
            <div class="description">
                <div class="ui header">You are going to give an appointment to {{this.nhc}}.</div>
                Text: <textarea rows="4" cols="50" id="inputDateAskModal"></textarea>
                <h3>Is it okay?</h3>
            </div>
        </div>
        <div class="actions">
            <div class="ui black cancel button">
                No
            </div>
            <div class="ui positive right labeled icon button">
                Yes
                <i class="checkmark icon"></i>
            </div>
        </div>
    </div>
    {{/with}}
</template>

<template name="dateUpdateAskModal">
    {{#with event}}
        <div id='dateUpdateAskModal' class="ui modal">
            <div class="header">
                Alert!
            </div>
            <div class="content">
                <div class="description">
                    <div class="ui header">You are going to modify the appointment for {{this.patient.nhc}} and date {{formatDateTime this.date}}.</div>
                    Text: <textarea rows="4" cols="50" id="inputUpdateAskModal">{{this.text}}</textarea>
                    <h3>Is it okay?</h3>
                </div>
            </div>
            <div class="actions">
                <div class="ui black cancel button">
                    No
                </div>
                <div class="ui positive right labeled icon button">
                    Yes
                    <i class="checkmark icon"></i>
                </div>
            </div>
        </div>
    {{/with}}
</template>

<template name="dateRemoveAskModal">
    {{#with event}}
        <div id='dateRemoveAskModal' class="ui modal">
            <div class="header">
                Alert!
            </div>
            <div class="content">
                <div class="description">
                    <div class="ui header">You are going to delete the appointment for {{this.patient.nhc}} and date {{formatDateTime this.date}}.</div>
                    <h3>Is it okay?</h3>
                </div>
            </div>
            <div class="actions">
                <div class="ui black cancel button">
                    No
                </div>
                <div class="ui positive right labeled icon button">
                    Yes
                    <i class="checkmark icon"></i>
                </div>
            </div>
        </div>
    {{/with}}
</template>